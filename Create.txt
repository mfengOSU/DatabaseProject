
CREATE TABLE LIBRARY (
	City VARCHAR(20) NOT NULL,
	State VARCHAR(20) NOT NULL,
	PRIMARY KEY(City, State)
);
CREATE TABLE LIBRARIAN (
	LibrarianId INT NOT NULL,
	City VARCHAR(20),
	State VARCHAR(20),
	Name VARCHAR(30) NOT NULL,
	Salary REAL,
	PRIMARY KEY(LibrarianId),
	FOREIGN KEY (City, State) REFERENCES LIBRARY(City, State) ON UPDATE CASCADE ON DELETE SET NULL
);
CREATE TABLE ITEM (
	ItemNo INT NOT NULL,
	Type CHAR(1) NOT NULL,
	Rating INT,
	Title VARCHAR(30) NOT NULL,
	Year INT NOT NULL,
	Genre VARCHAR(30),
	Location VARCHAR(30),
	Status VARCHAR(30),
	PRIMARY KEY(ItemNo)
);
CREATE TABLE LIBRARY_ORDER (
	ItemNo INT NOT NULL,
	City VARCHAR(20) NOT NULL,
	State VARCHAR(20) NOT NULL,
	ArrivalDate DATE NOT NULL,
	Price REAL NOT NULL,
	Copies INT NOT NULL,
	PRIMARY KEY(ItemNo , City, State),
	FOREIGN KEY (ItemNo) REFERENCES ITEM(ItemNo) ON UPDATE CASCADE,
	FOREIGN KEY (City, State) REFERENCES LIBRARY(City, State) ON UPDATE CASCADE
);
CREATE TABLE LIBRARY_STORAGE (
	ItemNo INT NOT NULL,
	City VARCHAR(20) NOT NULL,
	State VARCHAR(20) NOT NULL,
	PRIMARY KEY(ItemNo, City, State),
	FOREIGN KEY (ItemNo) REFERENCES ITEM(ItemNo) ON UPDATE CASCADE,
	FOREIGN KEY (City, State) REFERENCES LIBRARY(City, State) ON UPDATE CASCADE
);
CREATE TABLE MOVIE (
	MovieNo INT NOT NULL,
	Length INT NOT NULL,
	Director VARCHAR(30) NOT NULL,
	PRIMARY KEY(MovieNo),
	FOREIGN KEY(MovieNo) REFERENCES ITEM(ItemNo) ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE ARTIST (
	ArtistId INT NOT NULL,
	Name VARCHAR(30) NOT NULL,
	PRIMARY KEY(ArtistId)
);
CREATE TABLE ALBUM (
AlbumNo INT NOT NULL,
	ArtistId INT NOT NULL,
	PRIMARY KEY(AlbumNo),
	FOREIGN KEY(AlbumNo) REFERENCES ITEM(ItemNo) ON UPDATE CASCADE ON DELETE CASCADE,
	FOREIGN KEY(ArtistId) REFERENCES ARTIST(ArtistId) ON UPDATE CASCADE ON DELETE CASCADE
);
CREATE TABLE TRACK (
	AlbumNo INT NOT NULL,
	Title VARCHAR(30) NOT NULL,
	Length INT,
	PRIMARY KEY(AlbumNo, Title),
	FOREIGN KEY(AlbumNo) REFERENCES ALBUM(AlbumNo) ON UPDATE CASCADE ON DELETE CASCADE
);
CREATE TABLE AUTHOR (
AuthorId INT NOT NULL,
	Name VARCHAR(30) NOT NULL,
	PRIMARY KEY(AuthorId)
);
CREATE TABLE NARRATOR (
NarratorId INT NOT NULL,
	Name VARCHAR(30) NOT NULL,
	PRIMARY KEY(NarratorId)
);
CREATE TABLE AUDIOBOOK (
	BookNo INT NOT NULL,
	Length INT NOT NULL,
	Chapters INT NOT NULL,
	AuthorId INT NOT NULL,
	NarratorId INT NOT NULL,
	PRIMARY KEY(BookNo),
	FOREIGN KEY(BookNo) REFERENCES ITEM(ItemNo) ON UPDATE CASCADE ON DELETE CASCADE,
	FOREIGN KEY(AuthorId) REFERENCES AUTHOR(AuthorId) ON UPDATE CASCADE ON DELETE CASCADE,
	FOREIGN KEY(NarratorId) REFERENCES NARRATOR(NarratorId) ON UPDATE CASCADE ON DELETE CASCADE
);
CREATE TABLE ACTOR (
ActorId INT NOT NULL,
	Name VARCHAR(30) NOT NULL,
	PRIMARY KEY(ActorId)
);
CREATE TABLE MOVIE_ACTORS (
ActorId INT NOT NULL,
MovieNo INT NOT NULL,
PRIMARY KEY(ActorId, MovieNo),
FOREIGN KEY(MovieNo) REFERENCES MOVIE(MovieNo) ON UPDATE CASCADE ON DELETE CASCADE,
	FOREIGN KEY(ActorId) REFERENCES ACTOR(ActorId) ON UPDATE CASCADE ON DELETE CASCADE

);

CREATE TABLE LIBRARY_CARD (
	LibraryCardNo INT NOT NULL,
	Active BOOLEAN NOT NULL DEFAULT false,
	PRIMARY KEY(LibraryCardNo)
);
CREATE TABLE PATRON (
	PatronId INT NOT NULL,
	LibraryCardNo INT,
	FName VARCHAR(20) NOT NULL,
	LName VARCHAR(20) NOT NULL,
	Address VARCHAR(40),
	Email VARCHAR(40),
	PRIMARY KEY(PatronId),
	FOREIGN KEY(LibraryCardNo) REFERENCES LIBRARY_CARD(LibraryCardNo) ON UPDATE CASCADE ON DELETE SET NULL
);
CREATE TABLE PATRON_RETURNS (
PatronId INT NOT NULL,
ItemNo INT NOT NULL,
PRIMARY KEY(PatronId, ItemNo),
FOREIGN KEY(PatronId) REFERENCES PATRON(PatronId) ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY(ItemNo) REFERENCES ITEM(ItemNo) ON UPDATE CASCADE ON DELETE CASCADE
);
CREATE TABLE PATRON_CHECKOUTS (
PatronId INT NOT NULL,
ItemNo INT NOT NULL,
DueDate DATE,
PRIMARY KEY(PatronId, ItemNo),
FOREIGN KEY(PatronId) REFERENCES PATRON(PatronId) ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY(ItemNo) REFERENCES ITEM(ItemNo) ON UPDATE CASCADE ON DELETE CASCADE
);
