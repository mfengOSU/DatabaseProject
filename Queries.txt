SELECT TRACK.Title, TRACK.AlbumNo
FROM TRACK
WHERE (TRACK.AlbumNo, TRACK.Title) IN (
    SELECT TRACK.AlbumNo, TRACK.Title
    FROM TRACK, ITEM, ALBUM, ARTIST
    WHERE ITEM.ItemNo = ALBUM.AlbumNo AND
    ALBUM.AlbumNo = TRACK.AlbumNo AND
    ALBUM.ArtistId = ARTIST.ArtistId AND
    ARTIST.Name = 'AC/DC' AND
    ITEM.Year < 2000
);

SELECT ITEM.Title, PATRON_CHECKOUTS.DueDate
FROM ITEM, PATRON_CHECKOUTS, MOVIE, PATRON
WHERE ITEM.ItemNo = MOVIE.MovieNo AND
    PATRON.PatronId = PATRON_CHECKOUTS.PatronId AND
    MOVIE.MovieNo = PATRON_CHECKOUTS.ItemNo AND
    PATRON.PatronId = 1 
;

SELECT ITEM.Title, ITEM.ItemNo
FROM ITEM, ALBUM, LIBRARY_ORDER
WHERE ITEM.ItemNo = ALBUM.AlbumNo AND
    LIBRARY_ORDER.ItemNo = ALBUM.AlbumNo AND
    ITEM.Status = 'INVENTORY' AND
    LIBRARY_ORDER.Copies < 2
;

SELECT Patron.FName, Patron.LName, Item.Title
FROM ITEM, MOVIE, PATRON, PATRON_CHECKOUTS, MOVIE_ACTORS, ACTOR
WHERE ITEM.ItemNo = MOVIE.MovieNo AND
    PATRON_CHECKOUTS.ItemNo = MOVIE.MovieNo AND
    ACTOR.ActorId = MOVIE_ACTORS.ActorId AND
    MOVIE_ACTORS.MovieNo = PATRON_CHECKOUTS.ItemNo AND
    PATRON.PatronId = PATRON_CHECKOUTS.PatronId AND
    ACTOR.ActorId = 12 
;

SELECT COUNT(*)
FROM ITEM, ALBUM, PATRON, PATRON_CHECKOUTS
WHERE ITEM.ItemNo = ALBUM.AlbumNo AND
    PATRON_CHECKOUTS.ItemNo = ALBUM.AlbumNo AND
    PATRON.PatronId = PATRON_CHECKOUTS.PatronId AND
    PATRON.PatronId = 5
;

SELECT PATRON.FName, PATRON.LName, COUNT(*) as NumberCheckedOut
FROM ITEM, PATRON, PATRON_CHECKOUTS
WHERE 
    PATRON_CHECKOUTS.ItemNo = ITEM.ItemNo AND
    PATRON.PatronId = PATRON_CHECKOUTS.PatronId 
GROUP BY PATRON.PatronId
ORDER BY DESC
LIMIT 1
;
